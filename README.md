Disclaimer  

I will not take any responsibility for your trade's & money.  
Since I'm no longer pine-script coder, these codes are not maintained for long time.  
I'm keeping them for my personal trading idea storage.

I recommend you to convert version4 codes to ver5 or latest pine.